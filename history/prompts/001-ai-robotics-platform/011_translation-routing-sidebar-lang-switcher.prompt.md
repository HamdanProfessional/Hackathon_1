---
id: 011
title: translation-routing-sidebar-lang-switcher
stage: green
date: 2025-12-02
surface: claude-code
model: claude-sonnet-4-5
feature: 001-ai-robotics-platform
branch: 001-ai-robotics-platform
user: HamdanProfessional
command: /sp.phr
labels: [i18n, translation, routing, sidebar, language-switcher, docusaurus]
links:
  spec: specs/001-ai-robotics-platform/spec.md
  ticket: null
  adr: null
  pr: null
files:
  - path: web/sidebars.js
    action: modified
    reason: Split into separate englishSidebar and urduSidebar with respective dirNames
  - path: web/src/components/LangSwitcher.tsx
    action: created
    reason: Language toggle component for switching between English and Urdu docs
  - path: web/src/components/LangSwitcher.module.css
    action: created
    reason: Styling for language switcher component
  - path: web/src/theme/Navbar/Content/index.tsx
    action: created
    reason: Swizzled navbar to inject LangSwitcher component
tests:
  - Build test: npm run build (PASS)
---

## Prompt

Fix Translation Routing & Sidebar Logic

**Goal:** Strictly separate English (`/docs/en/`) and Urdu (`/docs/ur/`) navigation and add a toggle button.

### 1. Split Sidebars (`web/sidebars.js`)
*   **Action:** Create two separate sidebar configurations:
    *   `englishSidebar` ‚Üí Only scans `web/docs/en/`
    *   `urduSidebar` ‚Üí Only scans `web/docs/ur/`
*   **Config:** Use `{type: 'autogenerated', dirName: 'en'}` and `{type: 'autogenerated', dirName: 'ur'}` respectively.

### 2. Create LangSwitcher Component (`web/src/components/LangSwitcher.tsx`)
*   **Logic:** Detect current language from pathname (`.includes('/docs/en/')` vs `.includes('/docs/ur/')`).
*   **UI:** Display current language badge (e.g., "EN" or "UR") and a clickable link to switch.
*   **URL Transformation:** When on `/docs/en/page`, link to `/docs/ur/page` (and vice versa), preserving the page path.
*   **Display Text:** Use "ÿßÿ±ÿØŸà" for Urdu and "English" for English.

### 3. Add to Navbar (`web/src/theme/Navbar/Content/index.tsx`)
*   **Action:** Swizzle the Navbar Content component.
*   **Integration:** Inject `<LangSwitcher />` into the navbar content.

### 4. Default Route
*   **Verify:** Ensure the homepage (`web/src/pages/index.tsx`) links to `/docs/en/intro` as the default English entry point.

## Response snapshot

Successfully implemented translation routing with separate English and Urdu sidebars and a functional language switcher component integrated into the navbar.

### 1. Split Sidebars

Updated `web/sidebars.js`:
- **Changed from:** Single `tutorialSidebar` scanning all docs
- **Changed to:** Separate sidebars:
  - `englishSidebar` with `dirName: 'en'` (scans only `web/docs/en/`)
  - `urduSidebar` with `dirName: 'ur'` (scans only `web/docs/ur/`)

### 2. LangSwitcher Component

Created `web/src/components/LangSwitcher.tsx`:
- **Detection Logic:** Uses `useLocation()` to check pathname for `/docs/en/` or `/docs/ur/`
- **Visibility:** Only renders on docs pages (returns null otherwise)
- **URL Transformation:** Replaces `/docs/en/` ‚Üî `/docs/ur/` while preserving page path
- **UI Display:**
  - Current language badge: "EN" or "UR"
  - Toggle button: "ÿßÿ±ÿØŸà" (when on English) or "English" (when on Urdu)
  - Tooltip with accessibility title

Created `web/src/components/LangSwitcher.module.css`:
- Pill-shaped container with light background
- Badge for current language with darker background
- Hover states for toggle button
- Dark mode support with `[data-theme='dark']` selectors
- Responsive design for mobile (max-width: 996px)

### 3. Navbar Integration

Created `web/src/theme/Navbar/Content/index.tsx`:
- Swizzled Navbar Content component using wrapper pattern
- Imported original `Content` from `@theme-original/Navbar/Content`
- Injected `<LangSwitcher />` after the original content
- Maintains all original navbar functionality

### 4. Default Route Verification

Confirmed `web/src/pages/index.tsx` already links to `/docs/en/intro`:
```tsx
<Link to="/docs/en/intro">Start Learning ‚Üí</Link>
```

### Build Status

‚úÖ **Build Successful**: All files compiled without errors
- TypeScript compilation: PASS
- Static site generation: PASS
- Warnings: Only expected broken links for non-existent documentation files

## Outcome

- ‚úÖ Impact: Complete language routing separation with user-friendly language switcher, enabling independent navigation for English and Urdu documentation
- üß™ Tests: Build validation PASS, no TypeScript errors, SSR compatibility verified
- üìÅ Files: 3 new files created (LangSwitcher component, module CSS, navbar wrapper), 1 file modified (sidebars.js)
- üîÅ Next prompts: Add language preference persistence in localStorage, create actual Urdu documentation content, add language metadata to frontmatter
- üß† Reflection: Swizzling Navbar Content via wrapper pattern is cleaner than ejecting entire navbar. Pathname-based language detection is simple but effective for folder-based i18n routing.

## Evaluation notes (flywheel)

- Failure modes observed: None encountered. Implementation was straightforward with clear separation of concerns.
- Graders run and results (PASS/FAIL): Build test PASS, TypeScript compilation PASS, component integration PASS
- Prompt variant (if applicable): N/A
- Next experiment (smallest change to try): Test language switching with actual user navigation, add localStorage to remember language preference across sessions
